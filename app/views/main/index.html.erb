<% content_for(:page_title, t('main.index')) %>
<% content_for(:show_back_button, false) %>


<div class="max-w-md mx-auto px-4 py-4 space-y-4">

  <% if @partner.nil? %>
    <p>まだペアが設定されていません。</p>
  <% else %>
    <div>
      あなた: <%= current_user.name || "名無し" %> | 
      相手: <%= @partner.name || "名無し" %>
    </div>
  <% end %>

  <!-- 検索欄（仮） -->
  <div class="flex items-center space-x-2">
    <input type="text" placeholder="投稿の検索" class="flex-1 border rounded-lg px-3 py-2 text-sm" />
    <button class="px-4 py-2 text-sm bg-gray-200 rounded-lg">検索</button>

    <%= form_with url: "#", method: :get do |f| %>
      <%= f.collection_select :category_id, Category.all, :id, :name, prompt: "カテゴリを選択…" %>
    <% end %>
  </div>

  <!-- 投稿一覧 -->
  <div id="posts-list" class="space-y-4">
    <% if @posts.any? %> <!-- 1件以上あるか？ -->
      <h2 class="text-sm font-semibold text-gray-500 mb-2">
        最近の大事な投稿
      </h2>
      <% @high_posts.each do |post| %>
        <%= render "posts/post_card",
            post: post,
            last_viewed_at: @last_viewed_at %>
      <% end %>
      <h2 class="text-sm font-semibold text-gray-500 mb-2">
        通常投稿
     </h2>
      <% @other_posts.each do |post| %>
        <%= render "posts/post_card",
            post: post,
            last_viewed_at: @last_viewed_at %>
      <% end %>
    <% else %>
      <div class="bg-gray-100 rounded-lg p-4 text-gray-500 text-sm">
        投稿がまだありません
      </div>
    <% end %>
  </div>

</div>

<!-- 右下の追加ボタン -->
<%= link_to new_post_path,
  class: "fixed bottom-20 right-6 w-14 h-14 bg-pink-300 text-white rounded-full shadow-lg flex items-center justify-center text-3xl" do %>
  +
<% end %>



