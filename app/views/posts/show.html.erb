<% content_for(:page_title, @post.title_for_view(current_user)) %>
<% content_for(:show_back_button, true) %>


<!-- タイトル（答え合わせ時間での表示制御済み） -->
<h2><%= @post.title_for_view(current_user) %></h2>



<p>カテゴリ: <%= @post.category.name %></p>
<p>優先度: <%= @post.sense_level_jp %></p>
<p>投稿者: 
<% if @post.user.icon.present? %>
  <%= image_tag("user_icons/#{@post.user.icon}", alt: @post.user.name, class: "w-8 h-8 rounded-full inline-block ml-2") %>
<% end %>
<%= @post.user.name %>
</p>
<p>作成日: <%= @post.created_at.strftime("%Y/%m/%d %H:%M") %></p>
<p>答え合わせ日時: <%= @post.reveal_at.strftime("%Y/%m/%d %H:%M") %></p>


<% if @post.user == current_user %>
  <%= link_to edit_post_path(@post),
      class: "inline-flex items-center text-gray-500 hover:text-blue-500",
      title: "投稿を編集" do %>

    <svg xmlns="http://www.w3.org/2000/svg"
         class="w-5 h-5 mr-1"
         fill="none"
         viewBox="0 0 24 24"
         stroke="currentColor">
      <path stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M16.862 3.487a2.25 2.25 0 013.182 3.182L7.5 19.213
               3 21l1.787-4.5L16.862 3.487z" />
    </svg>

    編集
  <% end %>

  <%= button_to post_path(@post),
    method: :delete,
    data: { confirm: "本当に削除しますか？" },
    class: "inline-flex items-center text-red-500 hover:text-red-600 ml-4" do %>

  🗑️ 削除
  <% end %>
<% end %>


<h2>自分用メモ</h2>

<%= form_with model: @post_memo, local: true do |f| %>
  <%= f.hidden_field :post_id, value: @post.id %>
  <%= f.text_area :memo, rows: 5 %>
  <%= f.submit "保存" %>
<% end %>
