<% content_for(:page_title, t('notification_settings.show')) %>
<% content_for(:show_back_button, true) %>
<% content_for(:back_path, main_path) %>

<div class="bg-app min-h-screen px-4 py-6 space-y-6">

  <p class="text-wood-dark text-sm mb-4">
    ※アプリ内通知はOFFにできません
  </p>

  <%= form_with url: notification_settings_path, method: :patch, local: true do %>
    <div class="space-y-4">

      <% @notification_settings.each do |setting| %>
        <div class="bg-white rounded-xl shadow-md p-5 space-y-3">
          <h3 class="font-heading text-forest-green font-semibold text-sm">
            <%= t("notification_kinds.#{setting.notification_kind}") %>
          </h3>

          <% options =
            case setting.notification_kind
            when "new_post"
              [["すぐ通知", "immediate"], ["1日1回", "daily"]]
            when "weekly_summary"
              [["週1回", "weekly"]]
            when "post_unlocked", "anniversary"
              [["すぐ通知", "immediate"]]
            end
          %>

          <%= select_tag(
            "user_notification_settings[#{setting.id}][frequency]",
            options_for_select(
              [["通知しない", ""]] + options,
              setting.push_enabled ? setting.frequency : ""
            ),
            class: "w-full rounded-lg border border-wood-dark px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-sage"
          ) %>

        </div>
      <% end %>

    </div>

    <div class="mt-6">
      <%= submit_tag "保存する", class: "btn btn-primary w-full text-center" %>
    </div>
  <% end %>

</div>
